{"source_summary": {"root": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons", "engine": "python_ast_builtin", "parsed_files": 7, "errors": 0}, "metadata": [{"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/databricks_logger.py", "module": "databricks_logger", "docstring": null, "class_count": 1, "function_count": 0, "import_count": 4, "classes": [{"name": "SplunkLogger", "bases": [], "method_count": 8, "line_start": 7, "line_end": 283}], "functions": []}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/literals.py", "module": "literals", "docstring": null, "class_count": 0, "function_count": 0, "import_count": 0, "classes": [], "functions": []}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/schema_commons.py", "module": "schema_commons", "docstring": null, "class_count": 0, "function_count": 0, "import_count": 12, "classes": [], "functions": []}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/sftp_connection.py", "module": "sftp_connection", "docstring": null, "class_count": 0, "function_count": 6, "import_count": 3, "classes": [], "functions": [{"name": "get_sftp_secrets", "is_async": false, "line_start": 9, "line_end": 19, "param_count": 3}, {"name": "get_s3_object", "is_async": false, "line_start": 22, "line_end": 24, "param_count": 2}, {"name": "get_key_object", "is_async": false, "line_start": 27, "line_end": 30, "param_count": 2}, {"name": "connect_to_sftp", "is_async": false, "line_start": 32, "line_end": 51, "param_count": 6}, {"name": "get_sftp_files_in_directory", "is_async": false, "line_start": 54, "line_end": 83, "param_count": 2}, {"name": "archive_sftp_file", "is_async": false, "line_start": 88, "line_end": 117, "param_count": 2}]}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/splunk_logger.py", "module": "splunk_logger", "docstring": null, "class_count": 1, "function_count": 0, "import_count": 2, "classes": [{"name": "SplunkLogger", "bases": [], "method_count": 5, "line_start": 10, "line_end": 115}], "functions": []}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons.py", "module": "util_commons", "docstring": null, "class_count": 3, "function_count": 44, "import_count": 31, "classes": [{"name": "STSSession", "bases": [], "method_count": 1, "line_start": 61, "line_end": 87}, {"name": "AWSResource", "bases": [], "method_count": 3, "line_start": 92, "line_end": 106}, {"name": "SourceEmptyException", "bases": ["Exception"], "method_count": 0, "line_start": 287, "line_end": 288}], "functions": [{"name": "get_secret", "is_async": false, "line_start": 111, "line_end": 144, "param_count": 3}, {"name": "__get_event", "is_async": false, "line_start": 193, "line_end": 201, "param_count": 3}, {"name": "debug", "is_async": false, "line_start": 203, "line_end": 204, "param_count": 2}, {"name": "info", "is_async": false, "line_start": 206, "line_end": 207, "param_count": 2}, {"name": "warn", "is_async": false, "line_start": 209, "line_end": 210, "param_count": 2}, {"name": "error", "is_async": false, "line_start": 212, "line_end": 213, "param_count": 2}, {"name": "fatal", "is_async": false, "line_start": 215, "line_end": 216, "param_count": 2}, {"name": "get_pseudonym_secret", "is_async": false, "line_start": 236, "line_end": 237, "param_count": 1}, {"name": "encrypt", "is_async": false, "line_start": 241, "line_end": 261, "param_count": 2}, {"name": "decrypt", "is_async": false, "line_start": 265, "line_end": 275, "param_count": 2}, {"name": "pseudonymize", "is_async": false, "line_start": 279, "line_end": 283, "param_count": 2}, {"name": "logging_wrapper", "is_async": false, "line_start": 290, "line_end": 322, "param_count": 2}, {"name": "load_filtered_alpaca_data", "is_async": false, "line_start": 327, "line_end": 333, "param_count": 2}, {"name": "load_simpleui_data", "is_async": false, "line_start": 339, "line_end": 352, "param_count": 1}, {"name": "filter_alpaca_consented_with_intermediate_df", "is_async": false, "line_start": 356, "line_end": 368, "param_count": 3}, {"name": "add_cascade_id", "is_async": false, "line_start": 373, "line_end": 380, "param_count": 1}, {"name": "get_parquet_data", "is_async": false, "line_start": 384, "line_end": 385, "param_count": 1}, {"name": "get_delta_data", "is_async": false, "line_start": 387, "line_end": 390, "param_count": 2}, {"name": "get_delta_data", "is_async": false, "line_start": 396, "line_end": 396, "param_count": 2}, {"name": "get_unity_catalog_data", "is_async": false, "line_start": 398, "line_end": 399, "param_count": 1}, {"name": "get_csv_data", "is_async": false, "line_start": 404, "line_end": 410, "param_count": 2}, {"name": "get_decrypted_data_from_gpg", "is_async": false, "line_start": 412, "line_end": 418, "param_count": 2}, {"name": "get_redshift_data", "is_async": false, "line_start": 420, "line_end": 442, "param_count": 2}, {"name": "log_and_load_data", "is_async": false, "line_start": 444, "line_end": 535, "param_count": 2}, {"name": "write_parquet_data", "is_async": false, "line_start": 539, "line_end": 557, "param_count": 3}, {"name": "log_and_write_parquet_data", "is_async": false, "line_start": 559, "line_end": 596, "param_count": 3}, {"name": "log_and_write_delta_table", "is_async": false, "line_start": 598, "line_end": 623, "param_count": 3}, {"name": "write_unity_data", "is_async": false, "line_start": 625, "line_end": 639, "param_count": 4}, {"name": "log_and_write_unity_data", "is_async": false, "line_start": 641, "line_end": 678, "param_count": 4}, {"name": "get_raw_date", "is_async": false, "line_start": 681, "line_end": 686, "param_count": 2}, {"name": "get_date_list", "is_async": false, "line_start": 690, "line_end": 702, "param_count": 2}, {"name": "get_delta_metrics", "is_async": false, "line_start": 706, "line_end": 722, "param_count": 1}, {"name": "write_delta_table", "is_async": false, "line_start": 724, "line_end": 755, "param_count": 3}, {"name": "check_if_delta_exists", "is_async": false, "line_start": 757, "line_end": 777, "param_count": 2}, {"name": "delta_merge_file_status_update", "is_async": false, "line_start": 779, "line_end": 814, "param_count": 3}, {"name": "log_job_start", "is_async": false, "line_start": 818, "line_end": 823, "param_count": 2}, {"name": "log_job_skip", "is_async": false, "line_start": 825, "line_end": 830, "param_count": 2}, {"name": "log_job_done", "is_async": false, "line_start": 832, "line_end": 837, "param_count": 2}, {"name": "load_delta_table", "is_async": false, "line_start": 841, "line_end": 850, "param_count": 2}, {"name": "update_column_datatype", "is_async": false, "line_start": 854, "line_end": 858, "param_count": 3}, {"name": "add_null_app_deployed_uuid", "is_async": false, "line_start": 862, "line_end": 865, "param_count": 1}, {"name": "write_data_with_partitions", "is_async": false, "line_start": 870, "line_end": 897, "param_count": 4}, {"name": "log_and_write_data_with_partitions", "is_async": false, "line_start": 899, "line_end": 936, "param_count": 4}, {"name": "flush_logger_on_exit", "is_async": false, "line_start": 951, "line_end": 962, "param_count": 0}]}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons_test.py", "module": "util_commons_test", "docstring": null, "class_count": 3, "function_count": 44, "import_count": 31, "classes": [{"name": "STSSession", "bases": [], "method_count": 1, "line_start": 61, "line_end": 87}, {"name": "AWSResource", "bases": [], "method_count": 3, "line_start": 92, "line_end": 106}, {"name": "SourceEmptyException", "bases": ["Exception"], "method_count": 0, "line_start": 287, "line_end": 288}], "functions": [{"name": "get_secret", "is_async": false, "line_start": 111, "line_end": 144, "param_count": 3}, {"name": "__get_event", "is_async": false, "line_start": 193, "line_end": 201, "param_count": 3}, {"name": "debug", "is_async": false, "line_start": 203, "line_end": 204, "param_count": 2}, {"name": "info", "is_async": false, "line_start": 206, "line_end": 207, "param_count": 2}, {"name": "warn", "is_async": false, "line_start": 209, "line_end": 210, "param_count": 2}, {"name": "error", "is_async": false, "line_start": 212, "line_end": 213, "param_count": 2}, {"name": "fatal", "is_async": false, "line_start": 215, "line_end": 216, "param_count": 2}, {"name": "get_pseudonym_secret", "is_async": false, "line_start": 236, "line_end": 237, "param_count": 1}, {"name": "encrypt", "is_async": false, "line_start": 241, "line_end": 261, "param_count": 2}, {"name": "decrypt", "is_async": false, "line_start": 265, "line_end": 275, "param_count": 2}, {"name": "pseudonymize", "is_async": false, "line_start": 279, "line_end": 283, "param_count": 2}, {"name": "logging_wrapper", "is_async": false, "line_start": 290, "line_end": 322, "param_count": 2}, {"name": "load_filtered_alpaca_data", "is_async": false, "line_start": 327, "line_end": 333, "param_count": 2}, {"name": "load_simpleui_data", "is_async": false, "line_start": 339, "line_end": 352, "param_count": 1}, {"name": "filter_alpaca_consented_with_intermediate_df", "is_async": false, "line_start": 356, "line_end": 368, "param_count": 3}, {"name": "add_cascade_id", "is_async": false, "line_start": 373, "line_end": 380, "param_count": 1}, {"name": "get_parquet_data", "is_async": false, "line_start": 384, "line_end": 385, "param_count": 1}, {"name": "get_delta_data", "is_async": false, "line_start": 387, "line_end": 390, "param_count": 2}, {"name": "get_delta_data", "is_async": false, "line_start": 396, "line_end": 396, "param_count": 2}, {"name": "get_unity_catalog_data", "is_async": false, "line_start": 398, "line_end": 399, "param_count": 1}, {"name": "get_csv_data", "is_async": false, "line_start": 404, "line_end": 410, "param_count": 2}, {"name": "get_decrypted_data_from_gpg", "is_async": false, "line_start": 412, "line_end": 418, "param_count": 2}, {"name": "get_redshift_data", "is_async": false, "line_start": 420, "line_end": 442, "param_count": 2}, {"name": "log_and_load_data", "is_async": false, "line_start": 444, "line_end": 535, "param_count": 2}, {"name": "write_parquet_data", "is_async": false, "line_start": 539, "line_end": 557, "param_count": 3}, {"name": "log_and_write_parquet_data", "is_async": false, "line_start": 559, "line_end": 596, "param_count": 3}, {"name": "log_and_write_delta_table", "is_async": false, "line_start": 598, "line_end": 623, "param_count": 3}, {"name": "write_unity_data", "is_async": false, "line_start": 625, "line_end": 639, "param_count": 4}, {"name": "log_and_write_unity_data", "is_async": false, "line_start": 641, "line_end": 678, "param_count": 4}, {"name": "get_raw_date", "is_async": false, "line_start": 681, "line_end": 686, "param_count": 2}, {"name": "get_date_list", "is_async": false, "line_start": 690, "line_end": 702, "param_count": 2}, {"name": "get_delta_metrics", "is_async": false, "line_start": 706, "line_end": 722, "param_count": 1}, {"name": "write_delta_table", "is_async": false, "line_start": 724, "line_end": 755, "param_count": 3}, {"name": "check_if_delta_exists", "is_async": false, "line_start": 757, "line_end": 777, "param_count": 2}, {"name": "delta_merge_file_status_update", "is_async": false, "line_start": 779, "line_end": 814, "param_count": 3}, {"name": "log_job_start", "is_async": false, "line_start": 818, "line_end": 823, "param_count": 2}, {"name": "log_job_skip", "is_async": false, "line_start": 825, "line_end": 830, "param_count": 2}, {"name": "log_job_done", "is_async": false, "line_start": 832, "line_end": 837, "param_count": 2}, {"name": "load_delta_table", "is_async": false, "line_start": 841, "line_end": 850, "param_count": 2}, {"name": "update_column_datatype", "is_async": false, "line_start": 854, "line_end": 858, "param_count": 3}, {"name": "add_null_app_deployed_uuid", "is_async": false, "line_start": 862, "line_end": 865, "param_count": 1}, {"name": "write_data_with_partitions", "is_async": false, "line_start": 870, "line_end": 897, "param_count": 4}, {"name": "log_and_write_data_with_partitions", "is_async": false, "line_start": 899, "line_end": 936, "param_count": 4}, {"name": "flush_logger_on_exit", "is_async": false, "line_start": 951, "line_end": 962, "param_count": 0}]}], "dependency_graph": {"total_nodes": 32, "total_edges": 57, "internal_edges": 0, "external_edges": 57, "nodes": [{"id": "databricks_logger", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/databricks_logger.py"}, {"id": "literals", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/literals.py"}, {"id": "schema_commons", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/schema_commons.py"}, {"id": "sftp_connection", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/sftp_connection.py"}, {"id": "splunk_logger", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/splunk_logger.py"}, {"id": "util_commons", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons.py"}, {"id": "util_commons_test", "kind": "internal", "file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons_test.py"}, {"id": "requests", "kind": "external", "file": null}, {"id": "urllib3", "kind": "external", "file": null}, {"id": "pyspark.sql.types", "kind": "external", "file": null}, {"id": "json", "kind": "external", "file": null}, {"id": "datetime", "kind": "external", "file": null}, {"id": "pyspark.sql.functions", "kind": "external", "file": null}, {"id": "typing", "kind": "external", "file": null}, {"id": "pyspark.sql", "kind": "external", "file": null}, {"id": "pyspark.sql.window", "kind": "external", "file": null}, {"id": "delta.tables", "kind": "external", "file": null}, {"id": "distutils", "kind": "external", "file": null}, {"id": "botocore.exceptions", "kind": "external", "file": null}, {"id": "boto3", "kind": "external", "file": null}, {"id": "base64", "kind": "external", "file": null}, {"id": "Crypto.Cipher", "kind": "external", "file": null}, {"id": "pyspark.sql.utils", "kind": "external", "file": null}, {"id": "sys", "kind": "external", "file": null}, {"id": "gnupg", "kind": "external", "file": null}, {"id": "smart_open", "kind": "external", "file": null}, {"id": "pandas", "kind": "external", "file": null}, {"id": "warnings", "kind": "external", "file": null}, {"id": "os", "kind": "external", "file": null}, {"id": "io", "kind": "external", "file": null}, {"id": "atexit", "kind": "external", "file": null}, {"id": "paramiko", "kind": "external", "file": null}], "edges": [...]}, "abstract_syntax_tree": [{"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/databricks_logger.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/literals.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/schema_commons.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/sftp_connection.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/splunk_logger.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons.py", ...}, {"file": "/app/582a0181-7dd8-4568-b3f3-0b0b8dd822cf/commons/commons/util_commons_test.py", ...}]}